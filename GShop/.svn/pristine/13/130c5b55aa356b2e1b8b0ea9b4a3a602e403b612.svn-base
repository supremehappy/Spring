<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD MAPPER 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="noticeMapper">
	<!-- ReadDaoImpl -->
		<!-- FreeBBS -->
		<select id="getFreeBBSCount" resultType="Integer">
			select count(*) as num from t_bbs_free
		</select>
		
		<select id="getFreeBBSDetail" resultType="model.Bbs_free"
				parameterType="Integer">
		select * from t_bbs_free where seq = #{seq}
		</select>
		
		<select id="getFreeBBSList" parameterType="model.Condition" 
			resultType="model.Bbs_free">
			select seq,post_title, user_id ,post_content, reg_date, view_count
			from 
			(
				select a.*, rownum rn from
				(
					(select * from t_bbs_free
					order by seq desc) a
				)
			) where rn between #{startRow} and #{endRow}
		</select>
		
		<update id="updateFreeBBSViewCount" parameterType="model.Bbs_free">
			update t_bbs_free set view_count = #{view_count} where seq = #{seq}
		</update>
		
		<!-- NoticeBBS -->
		<select id="getNoticeBBSCount" resultType="Integer">
			select count(*) as num from t_bbs_notice
		</select>
		
		<select id="getNoticeBBSDetail" resultType="model.Notice"
				parameterType="Integer">
		select * from t_bbs_notice where seq = #{seq}
		</select>
		
		<select id="getNoticeBBSList" parameterType="model.Condition" 
			resultType="model.Notice">
			select seq, post_title, user_id, post_content, reg_date, view_count
			from 
			(
				select a.*, rownum rn from
				(
					(select * from t_bbs_notice
					order by seq desc) a
				)
			) where rn between #{startRow} and #{endRow}
		</select>
		
		<update id="updateNoticeBBSViewCount" parameterType="model.Notice">
			update t_bbs_notice set view_count = #{view_count} where seq = #{seq}
		</update>
		
	<!-- WriteDaoImpl -->
		<!-- FreeBBS -->
		<insert id="insertFreeWritingInfo" parameterType="model.Bbs_free">
			insert into t_bbs_free values(
			#{seq},#{group_id},#{parent_id},#{view_order},#{user_id},
			#{header_id},#{post_title},#{post_pw},#{reg_date},#{post_content},
			#{image1},#{image2},#{image3},#{image4},#{image5},#{view_count})
		</insert>
		
		<select id="getMaxFreeId" resultType="Integer">
			select max(seq) max_id from t_bbs_free
		</select>
				
		<update id="updateFreeBBS" parameterType="model.Bbs_free">
			update t_bbs_free 
			set header_id=#{header_id}, post_title=#{post_title}, post_content=#{post_content}, image1=#{image1}, image2=#{image2}, image3=#{image3}, image4=#{image4}, image5=#{image5} 
			where seq=#{seq}
		</update>
		
		<select id="findFreeBBSSeq" parameterType="Integer" resultType="model.Bbs_free">
			select * from t_bbs_free where seq = #{seq}
		</select>
		
		<delete id="deleteFreeBBS" parameterType="Integer">
			delete t_bbs_free where seq=#{seq}
		</delete>
		
		<!-- NoticeBBS -->
		<insert id="insertNoticeWritingInfo" parameterType="model.Notice">
			insert into t_bbs_notice values(
			#{seq},#{user_id},#{header_id},#{post_title},#{post_pw},
			#{reg_date},#{post_content},#{image1},#{image2},#{image3},
			#{image4},#{image5},#{view_count})
		</insert>
		
		<select id="getMaxNoticeId" resultType="Integer">
			select max(seq) max_id from t_bbs_notice
		</select>
		
		<update id="updateNoticeBBS" parameterType="model.Notice">
			update t_bbs_notice 
			set header_id=#{header_id}, post_title=#{post_title}, post_content=#{post_content}, image1=#{image1}, image2=#{image2}, image3=#{image3}, image4=#{image4}, image5=#{image5} 
			where seq=#{seq}
		</update>
		
		<select id="findNoticeBBSSeq" parameterType="Integer" resultType="model.Notice">
			select * from t_bbs_notice where seq = #{seq}
		</select>
		
		<delete id="deleteNoticeBBS" parameterType="Integer">
			delete t_bbs_notice where seq=#{seq}
		</delete>
		
	<!-- HeaderDaoImpl -->
	<select id="findHeaderAll" resultType="model.Header" >
		select header_id, header_name from t_header
	</select>
	
	<select id="findFreeBBSHeaderOne" resultType="model.Header" parameterType="Integer"> 
		select b.seq, b.header_id, h.header_name
		from t_bbs_free b join t_header h
		on b.header_id = h.header_id
		join t_user u
		on b.seq = #{seq}
	</select>
	
	<select id="findNoticeBBSHeaderOne" resultType="model.Header" parameterType="Integer">
		select b.seq, b.header_id, h.header_name
		from t_bbs_notice b join t_header h
		on b.header_id = h.header_id and b.seq=#{seq}
	</select>
	<!--  -->
	
</mapper>